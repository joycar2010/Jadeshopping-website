<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设置测试用户数据</title>
</head>
<body>
    <h1>设置测试用户数据到 localStorage</h1>
    <button onclick="setupTestUsers()">设置测试用户数据</button>
    <button onclick="clearUserData()">清除用户数据</button>
    <button onclick="showCurrentData()">显示当前数据</button>
    <div id="output"></div>

    <script>
        function setupTestUsers() {
            const users = [
                {
                    id: 'user_1735689600000',
                    username: 'testuser1',
                    email: 'test1@example.com',
                    full_name: '测试用户1',
                    phone: '13800138001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2024-01-15T08:30:00Z',
                    last_login: '2024-12-15T10:30:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 8,
                    total_spent: 2580.50,
                    membership_level: 'silver',
                    tags: ['活跃用户'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2024-01-15T08:30:00Z',
                    updated_at: '2024-12-15T10:30:00Z'
                },
                {
                    id: 'user_1735689700000',
                    username: 'vipuser',
                    email: 'vip@example.com',
                    full_name: 'VIP用户',
                    phone: '13900139001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2023-06-10T14:20:00Z',
                    last_login: '2024-12-15T09:15:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 25,
                    total_spent: 8950.00,
                    membership_level: 'gold',
                    tags: ['VIP客户', '活跃用户'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2023-06-10T14:20:00Z',
                    updated_at: '2024-12-15T09:15:00Z'
                },
                {
                    id: 'user_1735689800000',
                    username: 'newuser',
                    email: 'new@example.com',
                    full_name: '新用户',
                    phone: '13700137001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2024-12-01T16:45:00Z',
                    last_login: '2024-12-14T20:10:00Z',
                    email_verified: false,
                    phone_verified: false,
                    total_orders: 1,
                    total_spent: 299.00,
                    membership_level: 'bronze',
                    tags: ['新用户'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2024-12-01T16:45:00Z',
                    updated_at: '2024-12-14T20:10:00Z'
                },
                {
                    id: 'user_1735689900000',
                    username: 'suspendeduser',
                    email: 'suspended@example.com',
                    full_name: '被暂停用户',
                    phone: '13600136001',
                    avatar: '',
                    status: 'suspended',
                    registration_date: '2024-03-20T11:30:00Z',
                    last_login: '2024-11-15T14:20:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 3,
                    total_spent: 450.00,
                    membership_level: 'bronze',
                    tags: ['风险用户'],
                    permissions: ['user:read'],
                    created_at: '2024-03-20T11:30:00Z',
                    updated_at: '2024-11-20T09:00:00Z'
                }
            ];

            try {
                // 保存用户数据到 localStorage
                localStorage.setItem('jade-shopping-users', JSON.stringify(users));
                
                // 设置一个当前登录用户（用于测试）
                const currentUser = {
                    id: 'user_1735689600000',
                    username: 'testuser1',
                    email: 'test1@example.com',
                    full_name: '测试用户1',
                    phone: '13800138001',
                    avatar: '',
                    status: 'active',
                    email_verified: true,
                    phone_verified: true,
                    membership_level: 'silver'
                };
                
                // 模拟 Zustand persist 存储结构
                const zustandState = {
                    state: {
                        user: currentUser,
                        isAuthenticated: true,
                        allUsers: users
                    },
                    version: 0
                };
                
                localStorage.setItem('jade-shopping-store', JSON.stringify(zustandState));
                
                document.getElementById('output').innerHTML = `
                    <div style="color: green; margin-top: 20px;">
                        <h3>✅ 测试用户数据设置成功！</h3>
                        <p>已保存 ${users.length} 个测试用户到 localStorage</p>
                        <p>当前登录用户: ${currentUser.username} (${currentUser.email})</p>
                        <p>请刷新管理页面查看效果</p>
                    </div>
                `;
                
                console.log('测试用户数据已保存到 localStorage');
                console.log('用户数量:', users.length);
                users.forEach(user => {
                    console.log('- 用户:', user.username, '(' + user.email + ')', '状态:', user.status);
                });
                
            } catch (error) {
                document.getElementById('output').innerHTML = `
                    <div style="color: red; margin-top: 20px;">
                        <h3>❌ 设置失败</h3>
                        <p>错误: ${error.message}</p>
                    </div>
                `;
                console.error('设置测试用户数据失败:', error);
            }
        }

        function clearUserData() {
            localStorage.removeItem('jade-shopping-users');
            localStorage.removeItem('jade-shopping-store');
            document.getElementById('output').innerHTML = `
                <div style="color: orange; margin-top: 20px;">
                    <h3>🗑️ 用户数据已清除</h3>
                </div>
            `;
            console.log('用户数据已从 localStorage 清除');
        }

        function showCurrentData() {
            const users = localStorage.getItem('jade-shopping-users');
            const store = localStorage.getItem('jade-shopping-store');
            
            let output = '<div style="margin-top: 20px;"><h3>当前 localStorage 数据:</h3>';
            
            if (users) {
                const parsedUsers = JSON.parse(users);
                output += `<p><strong>jade-shopping-users:</strong> ${parsedUsers.length} 个用户</p>`;
            } else {
                output += '<p><strong>jade-shopping-users:</strong> 无数据</p>';
            }
            
            if (store) {
                const parsedStore = JSON.parse(store);
                output += `<p><strong>jade-shopping-store:</strong> 已设置 (用户: ${parsedStore.state?.user?.username || '无'})</p>`;
            } else {
                output += '<p><strong>jade-shopping-store:</strong> 无数据</p>';
            }
            
            output += '</div>';
            document.getElementById('output').innerHTML = output;
        }
    </script>
</body>
</html>