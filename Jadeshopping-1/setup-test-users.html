<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®¾ç½®æµ‹è¯•ç”¨æˆ·æ•°æ®</title>
</head>
<body>
    <h1>è®¾ç½®æµ‹è¯•ç”¨æˆ·æ•°æ®åˆ° localStorage</h1>
    <button onclick="setupTestUsers()">è®¾ç½®æµ‹è¯•ç”¨æˆ·æ•°æ®</button>
    <button onclick="clearUserData()">æ¸…é™¤ç”¨æˆ·æ•°æ®</button>
    <button onclick="showCurrentData()">æ˜¾ç¤ºå½“å‰æ•°æ®</button>
    <div id="output"></div>

    <script>
        function setupTestUsers() {
            const users = [
                {
                    id: 'user_1735689600000',
                    username: 'testuser1',
                    email: 'test1@example.com',
                    full_name: 'æµ‹è¯•ç”¨æˆ·1',
                    phone: '13800138001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2024-01-15T08:30:00Z',
                    last_login: '2024-12-15T10:30:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 8,
                    total_spent: 2580.50,
                    membership_level: 'silver',
                    tags: ['æ´»è·ƒç”¨æˆ·'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2024-01-15T08:30:00Z',
                    updated_at: '2024-12-15T10:30:00Z'
                },
                {
                    id: 'user_1735689700000',
                    username: 'vipuser',
                    email: 'vip@example.com',
                    full_name: 'VIPç”¨æˆ·',
                    phone: '13900139001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2023-06-10T14:20:00Z',
                    last_login: '2024-12-15T09:15:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 25,
                    total_spent: 8950.00,
                    membership_level: 'gold',
                    tags: ['VIPå®¢æˆ·', 'æ´»è·ƒç”¨æˆ·'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2023-06-10T14:20:00Z',
                    updated_at: '2024-12-15T09:15:00Z'
                },
                {
                    id: 'user_1735689800000',
                    username: 'newuser',
                    email: 'new@example.com',
                    full_name: 'æ–°ç”¨æˆ·',
                    phone: '13700137001',
                    avatar: '',
                    status: 'active',
                    registration_date: '2024-12-01T16:45:00Z',
                    last_login: '2024-12-14T20:10:00Z',
                    email_verified: false,
                    phone_verified: false,
                    total_orders: 1,
                    total_spent: 299.00,
                    membership_level: 'bronze',
                    tags: ['æ–°ç”¨æˆ·'],
                    permissions: ['user:read', 'order:create'],
                    created_at: '2024-12-01T16:45:00Z',
                    updated_at: '2024-12-14T20:10:00Z'
                },
                {
                    id: 'user_1735689900000',
                    username: 'suspendeduser',
                    email: 'suspended@example.com',
                    full_name: 'è¢«æš‚åœç”¨æˆ·',
                    phone: '13600136001',
                    avatar: '',
                    status: 'suspended',
                    registration_date: '2024-03-20T11:30:00Z',
                    last_login: '2024-11-15T14:20:00Z',
                    email_verified: true,
                    phone_verified: true,
                    total_orders: 3,
                    total_spent: 450.00,
                    membership_level: 'bronze',
                    tags: ['é£é™©ç”¨æˆ·'],
                    permissions: ['user:read'],
                    created_at: '2024-03-20T11:30:00Z',
                    updated_at: '2024-11-20T09:00:00Z'
                }
            ];

            try {
                // ä¿å­˜ç”¨æˆ·æ•°æ®åˆ° localStorage
                localStorage.setItem('jade-shopping-users', JSON.stringify(users));
                
                // è®¾ç½®ä¸€ä¸ªå½“å‰ç™»å½•ç”¨æˆ·ï¼ˆç”¨äºæµ‹è¯•ï¼‰
                const currentUser = {
                    id: 'user_1735689600000',
                    username: 'testuser1',
                    email: 'test1@example.com',
                    full_name: 'æµ‹è¯•ç”¨æˆ·1',
                    phone: '13800138001',
                    avatar: '',
                    status: 'active',
                    email_verified: true,
                    phone_verified: true,
                    membership_level: 'silver'
                };
                
                // æ¨¡æ‹Ÿ Zustand persist å­˜å‚¨ç»“æ„
                const zustandState = {
                    state: {
                        user: currentUser,
                        isAuthenticated: true,
                        allUsers: users
                    },
                    version: 0
                };
                
                localStorage.setItem('jade-shopping-store', JSON.stringify(zustandState));
                
                document.getElementById('output').innerHTML = `
                    <div style="color: green; margin-top: 20px;">
                        <h3>âœ… æµ‹è¯•ç”¨æˆ·æ•°æ®è®¾ç½®æˆåŠŸï¼</h3>
                        <p>å·²ä¿å­˜ ${users.length} ä¸ªæµ‹è¯•ç”¨æˆ·åˆ° localStorage</p>
                        <p>å½“å‰ç™»å½•ç”¨æˆ·: ${currentUser.username} (${currentUser.email})</p>
                        <p>è¯·åˆ·æ–°ç®¡ç†é¡µé¢æŸ¥çœ‹æ•ˆæœ</p>
                    </div>
                `;
                
                console.log('æµ‹è¯•ç”¨æˆ·æ•°æ®å·²ä¿å­˜åˆ° localStorage');
                console.log('ç”¨æˆ·æ•°é‡:', users.length);
                users.forEach(user => {
                    console.log('- ç”¨æˆ·:', user.username, '(' + user.email + ')', 'çŠ¶æ€:', user.status);
                });
                
            } catch (error) {
                document.getElementById('output').innerHTML = `
                    <div style="color: red; margin-top: 20px;">
                        <h3>âŒ è®¾ç½®å¤±è´¥</h3>
                        <p>é”™è¯¯: ${error.message}</p>
                    </div>
                `;
                console.error('è®¾ç½®æµ‹è¯•ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
            }
        }

        function clearUserData() {
            localStorage.removeItem('jade-shopping-users');
            localStorage.removeItem('jade-shopping-store');
            document.getElementById('output').innerHTML = `
                <div style="color: orange; margin-top: 20px;">
                    <h3>ğŸ—‘ï¸ ç”¨æˆ·æ•°æ®å·²æ¸…é™¤</h3>
                </div>
            `;
            console.log('ç”¨æˆ·æ•°æ®å·²ä» localStorage æ¸…é™¤');
        }

        function showCurrentData() {
            const users = localStorage.getItem('jade-shopping-users');
            const store = localStorage.getItem('jade-shopping-store');
            
            let output = '<div style="margin-top: 20px;"><h3>å½“å‰ localStorage æ•°æ®:</h3>';
            
            if (users) {
                const parsedUsers = JSON.parse(users);
                output += `<p><strong>jade-shopping-users:</strong> ${parsedUsers.length} ä¸ªç”¨æˆ·</p>`;
            } else {
                output += '<p><strong>jade-shopping-users:</strong> æ— æ•°æ®</p>';
            }
            
            if (store) {
                const parsedStore = JSON.parse(store);
                output += `<p><strong>jade-shopping-store:</strong> å·²è®¾ç½® (ç”¨æˆ·: ${parsedStore.state?.user?.username || 'æ— '})</p>`;
            } else {
                output += '<p><strong>jade-shopping-store:</strong> æ— æ•°æ®</p>';
            }
            
            output += '</div>';
            document.getElementById('output').innerHTML = output;
        }
    </script>
</body>
</html>